{{page-title "Session"}}
<div class="container-fluid py-3">
  <div class="row justify-content-center">
    <div class="col-12 col-md-8 col-lg-6">
      
      <SessionStatus />
        
      <div class="my-4 text-center">
        <RefreshButton @onRefresh={{this.refreshData}} />
      </div>
      
      {{#if this.currentQuestion}}

        {{#unless this.showResults}}
          <QuestionDisplay @question={{this.currentQuestion}} />
        {{/unless}}
        
        <div class="mt-4">
          {{#unless this.showResults}}
            {{#if (eq this.activeScenario "simple_choice")}}
              <SimpleChoiceForm 
                @question={{this.currentQuestion}}
                @sessionId={{this.sessionId}}
                @deviceId={{this.deviceID}}
                @responseSubmitted={{this.responseSubmitted}}
                @onSubmit={{this.submitResponse}}
              />
            {{else if (eq this.activeScenario "choice_overload")}}
              <ChoiceOverloadForm 
                @question={{this.currentQuestion}}
                @sessionId={{this.sessionId}}
                @deviceId={{this.deviceID}}
                @responseSubmitted={{this.responseSubmitted}}
                @onSubmit={{this.submitResponse}}
              />
            {{else if (eq this.activeScenario "ranking")}}
              <RankingForm 
                @question={{this.currentQuestion}}
                @sessionId={{this.sessionId}}
                @deviceId={{this.deviceID}}
                @responseSubmitted={{this.responseSubmitted}}
                @onSubmit={{this.submitResponse}}
              />
            {{else if (eq this.activeScenario "point_allocation")}}
              <PointAllocationForm 
                @question={{this.currentQuestion}}
                @sessionId={{this.sessionId}}
                @deviceId={{this.deviceID}}
                @responseSubmitted={{this.responseSubmitted}}
                @onSubmit={{this.submitResponse}}
              />
            {{else if (eq this.activeScenario "approval_voting")}}
              <ApprovalVotingForm 
                @question={{this.currentQuestion}}
                @sessionId={{this.sessionId}}
                @deviceId={{this.deviceID}}
                @responseSubmitted={{this.responseSubmitted}}
                @onSubmit={{this.submitResponse}}
              />
            {{/if}}
          {{else}}
            <ResultsOverview @question={{this.currentQuestion}} />
          {{/unless}}
        </div>
        
        <div class="mt-4 text-center">
          <RefreshButton @onRefresh={{this.refreshData}} />
        </div>
        
      {{else}}
        <div class="card">
          <div class="card-body text-center py-5">
            <div class="spinner-border text-primary" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
            <p class="mt-3 text-muted">Loading session...</p>
          </div>
        </div>
      {{/if}}
      
    </div>
  </div>
</div>
{{outlet}}